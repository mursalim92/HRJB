<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8">
    <title>PT JHONLIN BARATAMA</title>
    <link rel="icon" type="image/x-icon" href="logo jb copy.png">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Bebas+Neue&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>

/* ===== app ver.130425 ===== */
        /* ===== VARIABLES ===== */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #2980b9;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #27ae60;
            --light: #ecf0f1;
            --dark: #34495e;
            --gray: #95a5a6;
            --gold: #f1c40f;
            --coal: #2c3e50;
            --dirt: #8B6B4B;
            --truck: #e74c3c;

            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;

            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-full: 50%;

            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);

            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }
/* SETTING STYLE ONLINE ATTENDANCE*/
        .text-primary {
            color: #263c53; /* Ganti dengan warna yang diinginkan */
            text-shadow: 2px 2px 4px rgba(213, 228, 14, 0.3); /* Efek timbul */
        }
        .text-accent {
            color: #ff4081; /* Ganti dengan warna yang diinginkan */
        }
        .mb-lg {
            margin-bottom: 1.5rem; /* Ganti dengan margin yang diinginkan */
        }
        .text-center {
            text-align: center;
        }

        /* ===== BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: url('https://raw.githubusercontent.com/mursalim92/HRJB/main/hd%20trucj.jpg') center/cover no-repeat fixed;
            min-height: 100vh;
            padding: var(--space-md);
            position: static;
        }

        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* ===== UTILITY CLASSES ===== */
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .flex-wrap { flex-wrap: wrap; }
        .flex-1 { flex: 1; }

        .gap-xs { gap: var(--space-xs); }
        .gap-sm { gap: var(--space-sm); }
        .gap-md { gap: var(--space-md); }
        .gap-lg { gap: var(--space-lg); }
        .gap-xl { gap: var(--space-xl); }

        .p-xs { padding: var(--space-xs); }
        .p-sm { padding: var(--space-sm); }
        .p-md { padding: var(--space-md); }
        .p-lg { padding: var(--space-lg); }
        .p-xl { padding: var(--space-xl); }

        .m-xs { margin: var(--space-xs); }
        .m-sm { margin: var(--space-sm); }
        .m-md { margin: var(--space-md); }
        .m-lg { margin: var(--space-lg); }
        .m-xl { margin: var(--space-xl); }

        .mb-xs { margin-bottom: var(--space-xs); }
        .mb-sm { margin-bottom: var(--space-sm); }
        .mb-md { margin-bottom: var(--space-md); }
        .mb-lg { margin-bottom: var(--space-lg); }
        .mb-xl { margin-bottom: var(--space-xl); }

        .text-center { text-align: center; }
        .text-uppercase { text-transform: uppercase; }
        .text-bold { font-weight: 700; }
        .text-light { font-weight: 300; }
        .text-accent { color: var(--accent); }
        .text-white { color: white; }

        .bg-primary { background-color: var(--primary); }
        .bg-light { background-color: var(--light); }
        .bg-white { background-color: white; }

        .rounded-sm { border-radius: var(--radius-sm); }
        .rounded-md { border-radius: var(--radius-md); }
        .rounded-lg { border-radius: var(--radius-lg); }
        .rounded-full { border-radius: var(--radius-full); }
        .border { border: 1px solid var(--light); }

        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }

        .w-full { width: 100%; }
        .max-w-500 { max-width: 500px; }
        .max-w-1000 { max-width: 1000px; }

        /* ===== COMPONENTS ===== */
        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(1px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            padding: var(--space-lg);
            position: static;
            border: 1px solid rgba(42, 35, 35, 0.2);
            overflow: hidden;
            z-index: 1;
        }

        .mining-header {
            background: url('https://raw.githubusercontent.com/mursalim92/HRJB/main/exca.jpg') center/cover no-repeat;
            color: white;
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            position: relative;
            overflow: hidden;
            min-height: 200px;
            backdrop-filter: blur(10px); /* Efek blur untuk efek kaca */
            border: 3px solid rgba(255, 215, 0, 0.5); /* Border transparan */
        }

        /* Tambahan untuk efek kaca */
        .mining-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 251, 251, 0.096); /* Warna latar belakang transparan */
            border-radius: var(--radius-md);
            z-index: 1;
        }

        .mining-header h1 {
            position: relative;
            z-index: 2; /* Pastikan teks berada di atas efek kaca */
        }



        .company-logo {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            overflow: hidden;
            border: 3px solid var(--gold);
            box-shadow: 0 0 15px rgba(241,196,15,0.5);
            background-color: white;
            position: relative;
            z-index: 1;
        }

        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: var(--space-md);
        }

        .mining-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.625rem;
            letter-spacing: 2px;
            margin-bottom: var(--space-sm);
            color: rgb(36, 106, 203);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
        }

        .mining-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: var(--gold);
            margin: var(--space-sm) auto;
        }

        .search-input {
            position: relative;
            flex: 1;
            max-width: 500px;
        }

        .search-input i {
            position: absolute;
            left: var(--space-md);
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-input input {
            width: 100%;
            padding: var(--space-sm) var(--space-md) var(--space-sm) 45px;
            border: 2px solid var(--light);
            border-radius: var(--radius-md);
            font-size: 1rem;
            transition: all var(--transition-normal);
        }

        .search-input input:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            border: none;
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-lg);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: rgba(52, 152, 219, 0.6);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 2px 5px rgba(0, 0, 0, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.1);
        }

        .btn-primary:hover {
            background: rgba(41, 128, 185, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transform: translateY(-2px);
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.15),
                inset 0 2px 2px rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .result-container {
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            width: 100%;
            min-height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
        }

        .result-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: inherit;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: -1;
        }

        .initial-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
            text-align: center;
            width: 100%;
            position: relative;
            z-index: 1;
        }

        @supports (-webkit-backdrop-filter: none) or (backdrop-filter: none) {
            .result-container {
                background: rgba(255, 255, 255, 0.15);
            }
            .result-container::before {
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
            }
        }

        @supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
            .result-container {
                background: rgba(255, 255, 255, 0.85);
            }
        }

        @media (max-width: 768px) {
            .result-container {
                min-height: 140px;
            }
            @supports (-webkit-touch-callout: none) {
                .result-container::before {
                    -webkit-backdrop-filter: saturate(180%) blur(15px);
                    backdrop-filter: saturate(180%) blur(15px);
                }
            }
            @supports (background: -webkit-canvas(text)) {
                .result-container::before {
                    backdrop-filter: blur(12px);
                }
            }
        }

        .initial-state i {
            color: var(--primary);
            font-size: 1.75rem;
            margin-bottom: var(--space-sm);
            text-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .initial-state h3 {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: var(--space-xs);
            text-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .initial-state p {
            color: var(--dark);
            font-weight: 500;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @supports not (backdrop-filter: blur(25px)) {
            .result-container {
                background: rgba(255, 255, 255, 0.85);
            }
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.1) 0%,
                rgba(255, 255, 255, 0) 100%
            );
            border-radius: var(--radius-md);
            z-index: -1;
        }

        .employee-card {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            box-shadow: 
                0 2px 5px rgba(0, 0, 0, 0.1),
                inset 0 1px 1px rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            width: 100%;
            overflow: hidden;
            position: relative;
            transition: all var(--transition-normal);
        }

        .employee-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.15) 0%,
                rgba(255, 255, 255, 0.05) 100%
            );
            border-radius: var(--radius-md);
            z-index: -1;
        }

        .employee-avatar {
            width: 80px;
            height: 80px;
            min-width: 80px;
            min-height: 80px;
            border-radius: var(--radius-full);
            background: rgba(52, 152, 219, 0.7);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            font-weight: bold;
            border: 2px solid rgba(241, 196, 15, 0.7);
            box-shadow: 
                0 0 10px rgba(241, 196, 15, 0.3),
                inset 0 0 5px rgba(255, 255, 255, 0.3);
            transition: all var(--transition-normal);
        }

        .employee-card:hover {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.15),
                inset 0 2px 2px rgba(255, 255, 255, 0.3);
        }

        .employee-avatar:hover {
            background: rgba(52, 152, 219, 0.9);
            border-color: rgba(241, 196, 15, 0.9);
            transform: scale(1.05);
        }

        @supports not (backdrop-filter: blur(10px)) {
            .employee-card {
                background: rgba(157, 42, 42, 0.7);
            }
            .employee-avatar {
                background: rgba(52, 152, 219, 0.9);
            }
        }

        /* AREA TABEL KALENDER */
        .calendar-title {
      text-align: center;
      font-size: 1.25rem;
      font-weight: bold;
      color: var(--accent);
      margin-top: 1rem;
    }
        .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
        margin-top: 1rem;
    }
        .calendar-header {
        background-color: var(--accent);
        color: white;
        font-weight: bold;
        text-align: center;
        padding: 6px 0;
        border-radius: 4px;
    }

        .calendar-cell {
        background-color: white;
        border: 1px solid var(--light);
        border-radius: 4px;
        text-align: center;
        padding: 6px;
        cursor: pointer;
        font-size: 0.75rem;
    }

        .calendar-cell.empty {
        background-color: transparent;
        border: none;
        cursor: default;
    }

        .calendar-date {
        font-weight: bold;
        font-size: 0.65rem;
        color: #555;
        margin-bottom: 4px;
        display: block;
    }
        /* AKHIR AREA TABEL KALENDER */

        .loading {
            display: flex;
            justify-content: center;
            padding: var(--space-xl);
            flex-direction: column;
            align-items: center;
        }

        .dual-spinner-container {
            position: relative;
            width: 100px;
            height: 100px;
            margin-bottom: var(--space-md);
        }

        .logo-spinner {
            width: 60px;
            height: 60px;
            position: absolute;
            top: 20px;
            left: 20px;
            animation: spin-clockwise 2s linear infinite;
        }

        .logo-spinner img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 5px;
        }

        .outer-circle {
            position: absolute;
            width: 100px;
            height: 100px;
            border: 5px solid transparent;
            border-top-color: var(--accent);
            border-bottom-color: var(--accent);
            border-radius: 50%;
            animation: spin-counterclockwise 2s linear infinite;
        }
        
        .outer-circle::before {
            content: '';
            position: absolute;
            width: 110%;
            height: 110%;
            top: -5%;
            left: -5%;
            border: 3px dashed var(--gold);
            border-radius: 50%;
            animation: spin-counterclockwise 3s linear infinite;
            opacity: 0.6;
        }

        @keyframes spin-clockwise {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes spin-counterclockwise {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-360deg); }
        }

        .loading-text {
            color: var(--accent);
            font-weight: bold;
            margin-top: var(--space-md);
        }

        .error-message {
            text-align: center;
            padding: var(--space-md);
            color: var(--danger);
            background-color: rgba(231, 76, 60, 0.1);
            border-radius: var(--radius-md);
            margin-top: var(--space-md);
            border: 1px solid rgba(231, 76, 60, 0.2);
        }

        .footer-signature {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 8px;
            color: var(--coal);
            background-color: rgba(255,255,255,0.9);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 15px;
            box-shadow: var(--shadow-sm);
            font-style: italic;
            border: 1px solid var(--light);
            z-index: 1000;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition-slow);
        }

        .popup-content {
            background: white;
            padding: var(--space-lg);
            border-radius: var(--radius-md);
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-lg);
            position: relative;
            transform: translateY(20px);
            transition: transform var(--transition-normal);
        }

        .popup-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .popup-overlay.active .popup-content {
            transform: translateY(0);
        }

        .popup-close {
            position: absolute;
            top: var(--space-sm);
            right: var(--space-md);
            font-size: 1.375rem;
            cursor: pointer;
            color: var(--gray);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes moveTruck {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }

        .marquee-system {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            --marquee-height: 2.2rem;
            --marquee-elements: 12;
            --marquee-elements-displayed: 6;
            --marquee-element-width: calc(var(--marquee-width) / var(--marquee-elements-displayed));
            --gold-accent: #f1c40f;
        }

        .marquee-track {
            height: var(--marquee-height);
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
        }

        .top-track {
            background: linear-gradient(90deg, #2c3e50 0%, #3498db 100%);
            border-bottom: 1px solid rgba(255,255,255,0.15);
        }

        .bottom-track {
            background: linear-gradient(90deg, #3498db 0%, #2c3e50 100%);
        }

        .marquee-content {
            display: flex;
            position: absolute;
            min-width: 100%;
            animation: scrollMarquee 40s linear infinite;
        }

        .bottom-track .marquee-content {
            animation: scrollMarquee 15s linear infinite;
        }

        .marquee-content span {
            display: inline-flex;
            align-items: center;
            white-space: nowrap;
            padding: 0 2.5rem;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.1rem;
            letter-spacing: 1px;
            color: white;
            position: relative;
        }

        .marquee-content span:after {
            content: "|";
            color: var(--gold-accent);
            position: absolute;
            right: 0;
            opacity: 0.7;
        }

        .marquee-content i {
            margin-right: 0.8rem;
            color: var(--gold-accent);
            font-size: 1rem;
        }

        @keyframes scrollMarquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .marquee-track:hover .marquee-content {
            animation-play-state: paused;
        }

        @media (max-width: 768px) {
            .marquee-system {
                --marquee-height: 2.2rem;
            }
            .marquee-content span {
                font-size: 0.9rem;
                padding: 0 1.8rem;
            }
            .marquee-content i {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 800px) {
            .container {
                width: 100%;
                max-width: 1000px;
                margin: 0 auto;
                background: rgba(255, 255, 255, 0.3);
                backdrop-filter: blur(1px);
                -webkit-backdrop-filter: blur(10px);
                border-radius: var(--radius-md);
                box-shadow: var(--shadow-lg);
                padding: var(--space-lg);
                position: static;
                border: 1px solid rgba(42, 35, 35, 0.2);
                overflow: hidden;
                z-index: 1;
            }
            .mining-title {
                font-size: 2rem;
            }
            .company-logo {
                width: 90px;
                height: 90px;
            }
            .search-container {
                flex-direction: column;
            }
            .search-input,
            .search-btn {
                width: 100%;
            }
            .employee-header {
                flex-direction: column;
                text-align: center;
            }
            .attendance-table {
                font-size: 0.6rem;
            }
            .attendance-table th,
            .attendance-table td {
                padding: 6px 3px;
                min-width: 35px;
            }
            .footer-signature {
                position: static;
                text-align: center;
                margin-top: var(--space-md);
                display: inline-block;
            }
            footer {
                margin-top: 40px;
                padding: 20px 0;
                border-top: 1px solid rgba(0,0,0,0.1);
                width: 100%;
            }
            .footer-container {
                max-width: 700px;
                margin: 0 auto;
                text-align: center;
            }
            .footer-main-text {
                color: var(--dark);
                font-size: 0.5rem;
                margin-bottom: 8px;
            }
            .footer-secondary-text {
                color: var(--gray);
                font-size: 0.3rem;
                font-style: italic;
            }
            .footer-separator {
                color: var(--gray);
                margin: 0 3px;
            }
            .footer-accent {
                color: var(--accent);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="mining-header text-center">
            <div class="flex justify-center items-center mb-md">
                <div class="company-logo">
                    <img src="logo jb copy.png" alt="PT JHONLIN BARATAMA Logo">
                </div>
            </div>
            <h1 class="mining-title">PT JHONLIN BARATAMA</h1>
            <p class="mining-subtitle text-white">
                HUMAN RESOURCES SYSTEM - SUNGAI DUA MINING PROJECT
            </p>
        </div>
        
        <h1 class="text-center mb-lg text-primary">
            <i class="fas fa-calendar-check text-accent"></i> ONLINE ATTENDANCE CHECK
        </h1>
        
        <div class="flex items-center justify-center gap-md mb-lg">
            <div class="search-input flex-1 max-w-500">
                <i class="fas fa-id-card"></i>
                <input type="text" id="nikInput" placeholder="Masukkan NIK karyawan" inputmode="numeric" pattern="[0-9]*">
            </div>
            <button class="btn btn-primary" onclick="loadData()">
                <i class="fas fa-search"></i> Cari Data
            </button>
        </div>
        
        <div class="result-container" id="resultContainer">
            <div class="initial-state" id="initialState">
                <i class="fas fa-search"></i>
                <h3>Masukkan NIK Karyawan</h3>
                <p>Data absensi akan muncul di sini</p>
            </div>
        </div>

        <footer style="margin-top: 20px; padding: 10px 0; border-top: 1px solid rgba(0,0,0,0.1); width: 100%;">
            <div style="max-width: 100%; margin: 0 auto; text-align: center; padding: 0 10px;">
                <p style="color: var(--dark); font-size: clamp(0.6rem, 1.8vw, 0.9rem); margin-bottom: 3px;">
                    <strong style="color: var(--accent);">HR Operational Sungai Dua</strong> 
                    <span style="color: var(--gray);">|</span> 
                    Developed by <strong>Mursalim A.K</strong>
                </p>
                <p style="color: var(--light); font-size: clamp(0.5rem, 10vw, 0.2rem); font-style: italic;">
                    For internal use only <span style="color: var(--gray);">|</span> 
                    &copy; 2025 PT Jhonlin Baratama
                </p>
            </div>
        </footer>
        
        <div class="popup-overlay" id="definitionPopup">
            <div class="popup-content bg-white">
                <span class="popup-close" onclick="closePopup()">&times;</span>
                <h3 class="text-primary mb-md border-b-2 border-accent pb-xs" id="popupCode">KODE</h3>
                <div class="popup-definition leading-8" id="popupDefinition">
                    Definisi akan muncul di sini
                </div>
            </div>
        </div>

        <!-- Fixed marquee system at bottom of page -->
        <div class="marquee-system" style="position: static; bottom: 0; left: 0; right: 0; z-index: -1;">
            <div class="marquee-track top-track">
                <div class="marquee-content">
                    <span><i class="fas fa-bullhorn"></i> PERIODE ABSENSI : 11 MARET - 10 APRIL 2025</span>
                    <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                    <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                    <!--span><i class="fas fa-calendar-alt"></i> SPL BELUM TERMASUK, AKAN RELEASE SEGERA..!!! </span-->
                    <span><i class="fas fa-users"></i>  </span>
                    <span><i class="fas fa-bullhorn"></i> PERIODE ABSENSI : 11 MARET - 10 APRIL 2025</span>
                    <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                    <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                    <!--span><i class="fas fa-calendar-alt"></i> SPL BELUM TERMASUK, AKAN RELEASE SEGERA..!!! </span-->
                    <span><i class="fas fa-users"></i>  </span>
                </div>
            </div>
            
            <div class="marquee-track bottom-track">
                <!--div class="marquee-content">
                    <span><i class="fas fa-truck-moving"></i> HUBUNGI ADMIN JIKA ADA KETIDAKSESUAIAN</span>
                    <span><i class="fas fa-mountain"></i> SEGALA BENTUK KETIDAKHADIRAN TANPA ALASAN, AKAN DIKATEGORIKAN SEBAGAI MANGKIR/ALFA</span>
                    <span><i class="fas fa-clock"></i> DISIPLIN WAKTU MERUPAKAN PENILAIAN PRESTASI KERJA UNTUK KARYAWAN</span>
                    <span><i class="fas fa-truck-moving"></i> HUBUNGI ADMIN JIKA ADA KETIDAKSESUAIAN</span>
                    <span><i class="fas fa-mountain"></i> SEGALA BENTUK KETIDAKHADIRAN TANPA ALASAN, AKAN DIKATEGORIKAN SEBAGAI MANGKIR/ALFA</span>
                    <span><i class="fas fa-clock"></i> DISIPLIN WAKTU MERUPAKAN PENILAIAN PRESTASI KERJA UNTUK KARYAWAN</span>
                </div-->
                <div class="marquee-content">
                <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                <span><i class="fas fa-hard-hat"></i> REVISI DIPERBOLEHKAN SAMPAI 12 APRIL 2025</span>
                <span><i class="fas fa-hard-hat"></i> SEGERA KONFIRMASI ABSENSI ANDA</span>
                
                </div>
            </div>

            
        </div>

        
        <script>
            const CODE_DEFINITIONS = {
                'S':'Ontime, Shift Siang.',
                'S11':'Telat <1 Jam, Shift Siang.',
                'S10':'Siang: Telat >2 Jam',
                'S9':'Siang: Telat >2 Jam',
                'S8':'Siang: Telat >2 Jam',
                'ES':'Ontime, Shift Siang.',
                'ES11':'Telat <1 Jam, Shift Siang.',
                'ES10':'Siang: Telat >2 Jam',
                'ES9':'Siang: Telat >2 Jam,',
                'SPC':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'ESPC':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'M':'Ontime, Shift Malam.',
                'M11':'Telat <1 Jam, Shift Malam.',
                'M10':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'M9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'M8':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EM':'Ontime, Shift Malam.',
                'EM11':'Telat <1 Jam, Shift Malam.',
                'EM10':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EM9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'MPC':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EMPC':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'SB':'Ontime, Shift Siang.',
                'SB10':'Telat <1 Jam, Shift Siang.',
                'SB9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'ESB':'Ontime, Shift Siang.',
                'ESB10':'Telat <1 Jam, Shift Siang.',
                'ESB9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'SBPC':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'ESBPC':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'MB':'Ontime, Shift Malam.',
                'MB10':'Telat <1 Jam, Shift Malam.',
                'MB9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EMB':'Ontime, Shift Malam.',
                'EMB10':'Telat <1 Jam, Shift Malam.',
                'EMB9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'MBPC':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EMBPC':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'PS':'Ontime, Shift Siang.',
                'PS10':'Telat <1 Jam, Shift Siang.',
                'PS9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'EPS':'Ontime, Shift Siang.',
                'EPS10':'Telat <1 Jam, Shift Siang.',
                'EPS9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'CPS':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'SLP':'Ontime, Shift Siang.',
                'ESLP':'Ontime, Shift Siang.',
                'PM':'Ontime, Shift Malam.',
                'PM9':'Telat <1 Jam, Shift Malam.',
                'EPM':'Ontime, Shift Malam.',
                'EPM9':'Telat <1 Jam, Shift Malam.',
                'CPM':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OS':'Ontime, Shift Siang.',
                'OS11':'Telat <1 Jam, Shift Siang.',
                'OS10':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OS9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OM':'Ontime, Shift Malam.',
                'OM11':'Telat <1 Jam, Shift Malam.',
                'OM10':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OM9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OSB':'Ontime, Shift Siang.',
                'OSB11':'Telat <1 Jam, Shift Siang.',
                'OSB10':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OSB9':'Siang: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OMB':'Ontime, Shift Malam.',
                'OMB11':'Telat <1 Jam, Shift Malam.',
                'OMB10':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'OMB9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'HLS':'Ontime, Shift Siang.Lembur Libur Perusahaan/Nasional',
                'HLS11':'Telat <1 Jam, Shift Siang.Lembur Libur Perusahaan/Nasional',
                'HLS10':'Siang: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLS9':'Siang: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLSPC':'Siang: Cepat Pulang,Lembur Libur Perusahaan/Nasional',
                'HLM':'Ontime, Shift Malam.Lembur Libur Perusahaan/Nasional',
                'HLM11':'Telat <1 Jam, Shift Malam.Lembur Libur Perusahaan/Nasional',
                'HLM10':'Malam: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLM9':'Malam: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLMPC':'Malam: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLSB':'Ontime, Shift Siang Lembur Libur Perusahaan/Nasional.',
                'HLSB10':'Telat <1 Jam, Shift Siang.Lembur Libur Perusahaan/Nasional',
                'HLSB9':'Siang: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLSBPC':'Siang: Telat >2 Jam, Lembur Libur Perusahaan/Nasional',
                'HLMB':'Ontime, Shift Malam.',
                'HLMB10':'Telat <1 Jam, Shift Malam.',
                'HLMB9':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'HLMBPC':'Malam: Telat >2 Jam, Cepat Pulang Atau Absen sekali',
                'DS':'Ontime, Shift Siang.DINAS',
                'EDS':'Ontime, Shift Siang.DINAS',
                'DM':'Ontime, Shift Malam.DINAS',
                'EDM':'Ontime, Shift Malam.DINAS',
                'DSB':'Ontime, Shift Siang.DINAS',
                'EDSB':'Ontime, Shift Siang.DINAS',
                'DMB':'Ontime, Shift Malam.DINAS',
                'EDMB':'Ontime, Shift Malam.DINAS',
                'DPM':'Ontime, Shift Malam.DINAS',
                'EDPM':'Ontime, Shift Malam.DINAS',
                'DHO':'Ontime, Shift Siang.DINAS',
                'SHO':'Ontime, Shift Siang.DINAS',
                'A':'Mangkir Tanpa keterangan',
                'Out':'Keluar/Resign/PHK',
                'In':'Belum Menjadi Karyawan',
                'O':'Mutasi',
                'L':'Libur Perusahaan/Nasional',
                'R':'Skorsing',
                'OFF':'Hari Off Karyawan',
                'FB':'FieldBreak',
                'CT':'Cuti Tahunan',
                'IC':'Ijin Potong Cuti',
                'ID':'Ijin Dispensasi',
                'SJ':'Sakit Rawat Jalan',
                'SI':'Sakit Rawat Inap',
                'SC':'Sakit control Penyakit Berkepanjangan',
                'SR':'Dirumahkan/ Efisiensi',
                'WAITING':'Masih Proses Olah Data tim HR Site',
            };

            const RED_FONT_CODES = ['s11','s10','s9','s8','es11','es10','es9','spc','espc','m11','m10','m9','m8','em11','em10','em9','mpc','empc','sb10','sb9','esb10','esb9','sbpc','esbpc','mb10','mb9','emb10','emb9','mbpc','embpc','ps10','ps9','eps10','eps9','cps','pm9','epm9','cpm','os11','os10','os9','om11','om10','om9','osb11','osb10','osb9','omb11','omb10','omb9','hls11','hls10','hls9','hlspc','hlm11','hlm10','hlm9','hlmpc','hlsb10','hlsb9','hlsbpc','hlmb10','hlmb9','hlmbpc'];

            const CODE_BG_COLORS = {
                'a': '#FF0000',
                'out': '#FF6347',
                'in': '#90EE90',
                'o': '#ADD8E6',
                'mutasi': '#ADD8E6',
                'l': '#FFA07A',
                'libur': '#FFA07A',
                'r': '#D8BFD8',
                'off': '#D3D3D3',
                'fb': '#FFC0CB',
                'ct': '#98FB98',
                'ic': '#E6E6FA',
                'id': '#F0E68C',
                'sj': '#B0E0E6',
                'sakit': '#B0E0E6',
                'si': '#FFDEAD',
                'sc': '#DA70D6',
                'sr': '#87CEFA',
                
            };

            function showDefinition(code) {
                const popup = document.getElementById('definitionPopup');
                const popupCode = document.getElementById('popupCode');
                const popupDefinition = document.getElementById('popupDefinition');

                popupCode.textContent = code;
                
                const numericValue = code.replace(',', '.');
                if (!isNaN(numericValue) && numericValue !== '' && code !== '-') {
                    popupDefinition.textContent = `${code} adalah Σ Overtime sistem upah Overtime`;
                } else if (CODE_DEFINITIONS[code.toUpperCase()]) {
                    popupDefinition.textContent = CODE_DEFINITIONS[code.toUpperCase()];
                } else {
                    popupDefinition.textContent = 'May Be Overtime';
                }
                
                popup.classList.add('active');
            }

            function getMonthName(monthIndex) {
                const bulan = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
                return bulan[monthIndex] || 'Bulan tidak valid';
                }
            function getDayName(dateStr) {
            const [day, month, year] = dateStr.split('/');
            const date = new Date(`${year}-${month}-${day}`);
            const hari = ['Min', 'Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'];
            return hari[date.getDay()];
            }
            function getStartOffset(dateStr) {
                const [day, month, year] = dateStr.split('/');
                const date = new Date(`${year}-${month}-${day}`);
                const dayIndex = date.getDay();
                return (dayIndex === 0) ? 6 : dayIndex - 1; // Minggu=0, jadi offset = 6
                }

                function generateCalendarHeader() {
                    const headers = ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab', 'Min'];
                    return headers.map(h => `<div class="calendar-header">${h}</div>`).join('');
                    }

                    function generateCalendarCells(dateColumns, data, dateLabels) {
                        const offset = getStartOffset(dateLabels[0]);
                        let html = '';

                        for (let i = 0; i < offset; i++) {
                            html += '<div class="calendar-cell empty"></div>';
                        }

                        for (let i = 0; i < dateColumns.length; i++) {
                            const cellValue = data[dateColumns[i]] ? data[dateColumns[i]].trim() : '-';
                            const lowerValue = cellValue.toLowerCase();
                            const isRedFont = RED_FONT_CODES.includes(lowerValue);
                            const bgColor = CODE_BG_COLORS[lowerValue] || '';
                            let style = '';
                            if (isRedFont) style += 'color: red;';
                            if (bgColor) style += `background-color: ${bgColor};`;

                            const tanggal = dateLabels[i].split('/')[0];
                            html += `<div class="calendar-cell" style="${style}" onclick="showDefinition('${cellValue}')">
                                        <span class="calendar-date">${tanggal}</span>
                                        ${cellValue}
                                    </div>`;
                        }
                        return html;
                        }




            function closePopup() {
                document.getElementById('definitionPopup').classList.remove('active');
            }

            function attachCellClickEvents() {
                const cells = document.querySelectorAll('.attendance-table td');
                cells.forEach(cell => {
                    cell.style.cursor = 'pointer';
                    cell.addEventListener('click', function() {
                        const code = this.textContent.trim();
                        if (code && code !== '-') {
                            showDefinition(code);
                        }
                    });
                });
            }
                
            async function loadData() {
                const SPREADSHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSuJPtEwzwo9O3MjCKYYQBbz_rGkod8Bjm4G13B4BwhD3RlmdP2WwBXK9Smy0mrlfdNvJtDHFCi-P9Y/pub?output=csv";
                const nik = document.getElementById("nikInput").value.trim();
                const resultDiv = document.getElementById("resultContainer");
                
                if (!nik) {
                    showError("Silakan masukkan NIK karyawan");
                    return;
                }
                
                resultDiv.innerHTML = `
                  <div class="loading">
                      <div class="dual-spinner-container">
                        <div class="logo-spinner">
                          <img src="logo jb copy.png" alt="PT JHONLIN BARATAMA Logo">
                        </div>
                        <div class="outer-circle"></div>
                      </div>
                      <div class="loading-text">Memuat data ...</div>
                    </div>
                `;
                
                try {
                    const response = await fetch(SPREADSHEET_URL);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    
                    const csvData = await response.text();
                    const rows = parseCSV(csvData);
                    const header = rows[0];

                    const dateColumns = [];
                    const dateLabels = [];
                    
                    for (let i = 4; i < header.length; i++) {
                        if (header[i].match(/^\d{2}\/\d{2}\/\d{4}$/)) {
                            dateColumns.push(i);
                            dateLabels.push(header[i].trim()); // ⬅️ ini penting: simpan lengkap!
                        }
                        }


                    const karyawan = rows.find(row => row[0].trim() === nik);
                    
                    if (karyawan) {
                        resultDiv.innerHTML = createEmployeeCard(karyawan, dateColumns, dateLabels);
                        attachCellClickEvents();
                    } else {
                        showError("Data karyawan tidak ditemukan");
                    }
                } catch (error) {
                    console.error("Error:", error);
                    showError(`Terjadi kesalahan: ${error.message}`);
                }
            }

            function parseCSV(csv) {
                const lines = csv.split('\n');
                return lines.map(line => {
                    const result = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let char of line) {
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current);
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    result.push(current);
                    return result;
                });
            }

            function createEmployeeCard(data, dateColumns, dateLabels) {
                const nama = data[1] || '-';
                const inisial = nama.split(' ').map(n => n[0]).join('').toUpperCase();
                const overtimeValue = data[35] || '';
                const overtimeNumber = overtimeValue ? parseFloat(overtimeValue.replace(',', '.')) : 0;
                const overtimeDisplay = overtimeNumber !== 0 ? `${overtimeNumber.toFixed(1)} jam` : 'Sistem Upah ALL-IN';

                
                
                // Kelompokkan tanggal berdasarkan bulan
                    const bulanMap = {};
                    dateLabels.forEach((label, i) => {
                    if (!label || typeof label !== 'string' || !label.includes('/')) return;

                    const [d, m, y] = label.split('/');
                    if (!d || !m || !y) return;

                    const key = `${m.trim()}/${y.trim()}`;
                    if (!bulanMap[key]) bulanMap[key] = { dateCols: [], labels: [] };
                    bulanMap[key].dateCols.push(dateColumns[i]);
                    bulanMap[key].labels.push(label);
                    });

                    let kalenderHTML = '';
                    for (const key in bulanMap) {
                    const [bulanStrRaw, tahunStrRaw] = key.split('/');
                    const bulanStr = bulanStrRaw?.trim();
                    const tahunStr = tahunStrRaw?.trim();
                    const bulan = parseInt(bulanStr, 10);
                    const tahun = parseInt(tahunStr, 10);

                    if (!bulanStr || !tahunStr || isNaN(bulan) || isNaN(tahun)) continue;

                    const monthName = getMonthName(bulan - 1);

                    kalenderHTML += `
                        <div class="calendar-title">${monthName} ${tahun}</div>
                        <div class="calendar-grid">
                        ${generateCalendarHeader()}
                        ${generateCalendarCells(bulanMap[key].dateCols, data, bulanMap[key].labels)}
                        </div>
                    `;
                    }



                return `
                    <div class="employee-card">
  <div class="flex items-center gap-lg mb-md">
    <div class="employee-avatar shadow">
      ${inisial}
    </div>
    <div>
      <h2 class="text-primary mb-xs" style="font-size: 1.3rem; margin-bottom: 0.25rem;">
        ${nama}
      </h2>
      <div class="flex flex-wrap gap-sm">
        <div class="badge-info"><i class="fas fa-id-badge"></i> NIK: ${data[0]}</div>
        <div class="badge-info"><i class="fas fa-user-tie"></i> Jabatan: ${data[2] || '-'}</div>
        <div class="badge-info"><i class="fas fa-building"></i> Dept.: ${data[3] || '-'}</div>
      </div>
    </div>
  </div>

                    <div class="bg-light border-l-4 border-accent p-md mb-md text-center font-bold">
                        <i class="fas fa-clock"></i> Jumlah Overtime ${overtimeDisplay}
                    </div>
                    
                    ${kalenderHTML}
                    </div>
    `;
            }

            
            
            function showError(message) {
                document.getElementById("resultContainer").innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>${message}</p>
                    </div>
                `;
            }
            
            document.getElementById("nikInput").addEventListener("keypress", e => {
                if (e.key === "Enter") loadData();
            });

            document.getElementById('definitionPopup').addEventListener('click', function(e) {
                if (e.target === this) closePopup();
            });
                
            if (window.innerWidth >= 992) {
                document.querySelector('.moving-truck').style.display = 'block';
            }
        </script>
    </div>
</body>
</html>