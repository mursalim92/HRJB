async function loadData() {
    const SPREADSHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSuJPtEwzwo9O3MjCKYYQBbz_rGkod8Bjm4G13B4BwhD3RlmdP2WwBXK9Smy0mrlfdNvJtDHFCi-P9Y/pub?output=csv";
    const nik = document.getElementById("nikInput").value.trim();
    const resultDiv = document.getElementById("resultContainer");

    // Tampilkan loading
    resultDiv.innerHTML = `<div class="loading"><div class="spinner"></div></div>`;

    try {
        const response = await fetch(SPREADSHEET_URL);
        const csvData = await response.text();
        const rows = csvData.split("\n");

        // Cari baris yang sesuai dengan NIK
        const targetRow = rows.find(row => row.split(",")[0].trim() === nik);
        if (!targetRow) throw new Error("Data tidak ditemukan");

        const data = targetRow.split(",");

        // Konversi nama kolom ke index (A=0, B=1, ..., AH=33, AI=34, dst.)
        function columnToIndex(column) {
            let index = 0;
            column = column.toUpperCase();
            for (let i = 0; i < column.length; i++) {
                index = index * 26 + (column.charCodeAt(i) - 65 + 1);
            }
            return index - 1; // Karena array dimulai dari 0
        }

        const startColIndex = columnToIndex("AH"); // AH -> index 33
        const absensiData = data.slice(startColIndex);

        // Buat label tanggal (11 sampai 10)
        const dates = [];
        for (let i = 11; i <= 31; i++) dates.push(i);  // 11-31
        for (let i = 1; i <= 10; i++) dates.push(i);    // 1-10

        // Generate HTML
        resultDiv.innerHTML = `
            <div class="employee-card">
                <table class="attendance-table">
                    <tr>
                        ${dates.map(date => `<th>Tgl ${date}</th>`).join('')}
                    </tr>
                    <tr>
                        ${absensiData.map((status, index) => {
                            if (index >= dates.length) return '';
                            const s = status.trim().toLowerCase();
                            let className = '';
                            if (s.includes('hadir')) className = 'status-hadir';
                            else if (s.includes('izin')) className = 'status-izin';
                            else if (s.includes('alpha')) className = 'status-alpha';
                            return `<td class="${className}">${status}</td>`;
                        }).join('')}
                    </tr>
                </table>
            </div>
        `;

    } catch (error) {
        resultDiv.innerHTML = `<div class="error">${error.message}</div>`;
    }
}
