async function loadData() {
    const SPREADSHEET_URL = "URL_CSV_ANDA";
    const nik = document.getElementById("nikInput").value.trim();
    const resultDiv = document.getElementById("resultContainer");

    // Tampilkan loading
    resultDiv.innerHTML = `<div class="loading"><div class="spinner"></div></div>`;

    try {
        const response = await fetch(SPREADSHEET_URL);
        const csvData = await response.text();
        const rows = csvData.split("\n");
        const header = rows[0].split(","); // Ambil header kolom

        // Cari index kolom AH (tgl 11) sampai BB (tgl 10)
        const dateColumns = [];
        for (let i = 0; i < header.length; i++) {
            if (header[i].trim() === "AH") {
                // Ambil 31 kolom setelah AH (tgl 11-31) + 10 kolom berikutnya (tgl 1-10)
                dateColumns.push(...Array.from({length: 31}, (_, j) => i + j)); // AH=11, AI=12, ..., AR=31
                dateColumns.push(...Array.from({length: 10}, (_, j) => i + 31 + j)); // AS=1, AT=2, ..., BB=10
                break;
            }
        }

        // Cari data karyawan
        const karyawan = rows.find(row => row.split(",")[0].trim() === nik);
        
        if (karyawan) {
            const data = karyawan.split(",");
            const nama = data[1] || '-';
            
            // Generate HTML untuk tabel absensi
            let tableHTML = `
                <table class="attendance-table">
                    <tr>
                        ${Array.from({length: 31}, (_, i) => `<th>Tgl ${i+11}</th>`).join('')}
                        ${Array.from({length: 10}, (_, i) => `<th>Tgl ${i+1}</th>`).join('')}
                    </tr>
                    <tr>
                        ${dateColumns.map(col => {
                            const status = data[col]?.trim() || '-';
                            let className = '';
                            if (status.includes('Hadir')) className = 'status-hadir';
                            else if (status.includes('Izin')) className = 'status-izin';
                            else if (status.includes('Alpha')) className = 'status-alpha';
                            return `<td class="${className}">${status}</td>`;
                        }).join('')}
                    </tr>
                </table>
            `;

            resultDiv.innerHTML = `
                <div class="employee-card">
                    <h2>${nama}</h2>
                    <div style="overflow-x:auto">${tableHTML}</div>
                </div>
            `;
        } else {
            showError("Data tidak ditemukan");
        }
    } catch (error) {
        showError(`Error: ${error.message}`);
    }
}
